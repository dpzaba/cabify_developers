## Journey Resource

~~~
https://cabify.com/api/journey
~~~

~~~json
{
    "org_unit_ids": [],
    "region_id": "madrid",
    "client_id": "2d2ca48e465d58c55d77b8d944e1b575",
    "user_id": "feceb9ec89bf76685af19ab5f865a781",
    "rider_id": "feceb9ec89bf76685af19ab5f865a781",
    "group_id": null,
    "driver_id": "611fe71601ee802af36202ff3e3e574b",
    "payer_id": null,
    "taxi_id": "611fe71601ee802af36202ff3e3e65cf",
    "agency_id": "0c4c7a7faf0785b7fab0edd59f199f7b",
    "company_id": "611fe71601ee802af36202ff3e3e7a95",
    "vehicle_type_id": "cdfd227d00eeeacb50359baa841facb5",
    "driver_shift_id": null,
    "user_preferences": {
        "music": null,
        "call": null,
        "ac": null,
        "open_door": null,
        "radio_stations": [],
        "other": null
    },
    "start_type": "asap",
    "start_at": "2014-02-05T13:09:45.533Z",
    "start_loc": [
        40.42185974121094,
        -3.707935333251953
    ],
    "start_name": "Gran Via",
    "start_city": "Centro, Madrid",
    "start_zone_id": "500999761cd3e9a277db32b617bc021d",
    "transfer_at": null,
    "end_loc": null,
    "end_at": "2014-02-06T21:04:41.411Z",
    "end_name": null,
    "end_city": null,
    "end_state": "failure",
    "real_start_loc": null,
    "real_end_loc": null,
    "hired_loc": null,
    "flight": null,
    "rider_name": null,
    "rider_mobile_cc": null,
    "rider_mobile_num": null,
    "rider_email": null,
    "rider_locale": null,
    "authorised_at": "2014-02-05T13:09:45.408Z",
    "started_at": "2014-02-05T13:09:45.533Z",
    "searching_at": "2014-02-05T13:09:45.564Z",
    "hired_at": "2014-02-05T13:09:53.100Z",
    "arrived_at": "2014-02-06T21:04:37.960Z",
    "pick_up_at": "2014-02-06T21:04:39.304Z",
    "drop_off_at": "2014-02-06T21:04:41.411Z",
    "terminated_at": "2014-10-23T09:31:00.817Z",
    "priced_at": null,
    "currency": "EUR",
    "supplements": [],
    "price_distance": 0,
    "price_duration": 1,
    "price_extra": null,
    "price": 1000,
    "price_base": 1000,
    "discount": null,
    "distance": 0,
    "duration": 1,
    "bird_distance": null,
    "waypoint_count": 2,
    "threshold": null,
    "moving": 0,
    "stopped": 1,
    "cost_distance": 0,
    "cost_duration": 0,
    "cost_extra": null,
    "cost": 1000,
    "cost_base": 1000,
    "cost_payable": 1000,
    "starred": false,
    "amount_payable": null,
    "amount_paid": null,
    "notes": null,
    "message": "",
    "rider_notes": null,
    "charge_code": null,
    "source": "iPhone",
    "user_agent": "Cabify/3.0.0.alpha5 CFNetwork/672.0.8 Darwin/14.0.0",
    "rider_waiting_time": 114892,
    "driver_waiting_time": 1,
    "public_id": "vg7ngwft",
    "alerts": [],
    "modification_message": null,
    "loyalty_program": {
        "loyalty_program_id": null,
        "card_number": null
    },
    "updated_at": "2015-06-11T15:53:14.274Z",
    "created_at": "2014-02-05T13:09:45.487Z",
    "_id": "2ce31633e28dde7a3058f431a4c8a910",
    "_rev": "11-faacd0c6c4241dcb86fb9ba4585971a9",
    "type": "Journey",
    "payment_method_id": "5852c04ba546edcffcbfe10ea3010c76",
    "price_formatted": "10.00 €",
    "price_distance_formatted": "0.00 €",
    "price_duration_formatted": "0.01 €",
    "price_extra_formatted": "0.00 €",
    "total": 1000,
    "total_formatted": "10.00 €",
    "discount_formatted": null,
    "preferred_driver_id": "611fe71601ee802af36202ff3e3e574b",
    "rider_mobile": "",
    "start_at_in_time_zone": "2014-02-05T14:09:45.533+01:00",
    "end_at_in_time_zone": "2014-02-06T22:04:41.411+01:00",
    "rider": {
        "org_unit_ids": [],
        "avatar_url": "https://cabify.s3.amazonaws.com/development/avatars/feceb9ec89bf76685af19ab5f865a781/thumb_photo.jpeg",
        "client_id": "2d2ca48e465d58c55d77b8d944e1b575",
        "group_id": null,
        "payment_method_id": null,
        "name": "Michael",
        "surname": "Koper (admin)",
        "email": "michael@cabify.com",
        "mobile_cc": "34",
        "mobile_num": "611111111",
        "role": "admin",
        "loc": [
            0,
            0
        ],
        "score": 5,
        "national_id_number": null,
        "email_cc": [],
        "disabled": false,
        "pending": false,
        "locale": "es-MX",
        "info_invitations_sent_at": null,
        "employee_code": null,
        "default_charge_code": null,
        "disable_user_events": false,
        "skip_notifications": {
            "journey": [],
            "promos": []
        },
        "preferences": {
            "music": null,
            "call": null,
            "ac": null,
            "open_door": null,
            "radio_stations": [],
            "other": null
        },
        "admin_agency_id": null,
        "notes": null,
        "agency_id": "0c4c7a7faf0785b7fab0edd59f199f7b",
        "company_id": "a1573558781c43644ea78083e00a8501",
        "fleet_role": null,
        "authorization_service_date": null,
        "active_region_id": null,
        "blacklist_detail_id": null,
        "updated_at": "2014-09-16T10:11:41.660Z",
        "_id": "feceb9ec89bf76685af19ab5f865a781",
        "_rev": "517-d46c72f94da01d51c6325fcfafd748a9",
        "preferred_region_id": "madrid",
        "reservation_notification": false,
        "tax_code": "",
        "region_id": "madrid",
        "type": "User",
        "mobile": "+34611111111",
        "full_name": "Michael Koper (admin)",
        "country": "MX",
        "language": "es",
        "company_name": "Maxi Mobility Spain S.L."
    },
    "driver": {
        "org_unit_ids": [],
        "avatar_url": "https://cabify.s3.amazonaws.com/development/avatars/611fe71601ee802af36202ff3e3e574b/thumb_photo.jpeg",
        "client_id": "611fe71601ee802af36202ff3e3e5c2a",
        "group_id": null,
        "payment_method_id": null,
        "name": "Kellys",
        "surname": "Slater",
        "email": "michael+taxi1@cabify.com",
        "mobile_cc": "34",
        "mobile_num": "611111111",
        "role": "user",
        "loc": null,
        "score": 4.8,
        "national_id_number": null,
        "email_cc": [],
        "disabled": false,
        "pending": false,
        "locale": "en-PE",
        "info_invitations_sent_at": null,
        "employee_code": "",
        "default_charge_code": null,
        "disable_user_events": false,
        "skip_notifications": {
            "journey": [],
            "promos": []
        },
        "preferences": {
            "music": null,
            "call": null,
            "ac": null,
            "open_door": null,
            "radio_stations": [],
            "other": ""
        },
        "admin_agency_id": null,
        "notes": "",
        "agency_id": "0c4c7a7faf0785b7fab0edd59f199f7b",
        "company_id": "611fe71601ee802af36202ff3e3e7a95",
        "fleet_role": "manager",
        "authorization_service_date": null,
        "active_region_id": null,
        "blacklist_detail_id": null,
        "updated_at": "2014-10-27T15:14:29.268Z",
        "_id": "611fe71601ee802af36202ff3e3e574b",
        "_rev": "188-7b7a9e17ec72802808afa4cc9489a992",
        "receive_user_events": true,
        "preferred_region_id": "madrid",
        "reservation_notification": false,
        "type": "User",
        "mobile": "+34611111111",
        "full_name": "Kellys Slater",
        "country": "PE",
        "language": "en",
        "company_name": "Michael Hippy Company"
    },
    "taxi": {
        "region_id": "madrid",
        "vehicle_type_ids": [
            "cdfd227d00eeeacb50359baa841facb5"
        ],
        "name": "Hippy Executive Car",
        "reg_plate": "h1ppy",
        "make": null,
        "model": null,
        "motor_type": null,
        "color": "black",
        "icon": "executive",
        "disabled": false,
        "manufacture_year": null,
        "updated_at": "2013-04-24T11:36:24.367Z",
        "created_at": "2012-10-10T09:33:38.776Z",
        "_id": "611fe71601ee802af36202ff3e3e65cf",
        "_rev": "8-e23d731f13f06efd261f69c27673c013",
        "type": "Taxi",
        "request_cost": false
    },
    "vehicle_type": {
        "_id": "cdfd227d00eeeacb50359baa841facb5",
        "_rev": "24-f21610b4649d8b4705d1f03beaff7dbe",
        "type": "VehicleType",
        "name": "Cabify Executives",
        "short_name": "Executive",
        "description": "Mercedes E Class or similar. 4 pax.",
        "region_id": "madrid",
        "reserved_only": false,
        "icon": "executive",
        "agency_id": "0c4c7a7faf0785b7fab0edd59f199f7b",
        "zone_ids": [
            "500999761cd3e9a277db32b617bc021d"
        ],
        "created_at": "2012-08-13T10:09:56.125Z",
        "updated_at": "2014-10-30T10:16:35.733Z"
    },
    "billable_amount": 1000,
    "on_shift": false,
    "driver_name": "Kellys Slater",
    "rider_rating_amount": null,
    "taxi_reg_plate": "h1ppy"
}
~~~


Table Header 1 | Table Header 2
-------------- | --------------
Row 1 col 1 | Row 1 col 2
Row 2 col 1 | Row 2 col 2


Create and fetch journeys resources.

### Actions

 * `POST` - create a new journey without an uuid
 * `PUT` - create a new journey with a uuid
 * `GET` - fetch the details of a journey

### Authentication

Only logged in users will be allowed to request a journey. The owner will always be taken from the currently logged in user, but journeys can be requested for _anonymous_ riders and other riders with a user in the same account.

### Creating a journey

There are two ways of creating a new journey:

 * Using `POST` with a journey request body.
 * Using `PUT` with a uuid generated by the client in the path, and the request body.

When possible, we always recommend trying to create a journey using the `PUT` method with a uuid generated by the client. If for some reason when creating a journey the server receives the request but the client does not receive a response, the journey can be re-requested with the same uuid and the server will respond with the original journey instead of creating a duplicate. This is especially useful in dealing with poor networks connections, such as when connected using 3G.

The request body should be provided as JSON and using a combination of the following properties.

<table class="table">
  <thead>
    <tr>
      <th>Property</th>
      <th>Type</th>
      <th>Required?</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>start_type</code></td>
      <td>String</td>
      <td>yes</td>
      <td>
        The type of journey to start, either: `asap` for on demand journeys or `reserve` for a reservation booking for some point in the future.
      </td>
    </tr>
    <tr>
      <td><code>start_at</code></td>
      <td>Local Date</td>
      <td>only "reserve"</td>
      <td>
        When the journey should be started in the case of a reservation. Should **always** be in the local time of the user requesting the journey in ISO 8601 format without any timezone details. Our server will handle timezone conversion. Example: "2014-11-14 13:45".
      </td>
    </tr>
    <tr>
      <td><code>start_loc</code></td>
      <td>[Float, Float]</td>
      <td>yes</td>
      <td>
        Array containing latitude and longitude of the exact pick up location.
      </td>
    </tr>
    <tr>
      <td><code>start_name</code></td>
      <td>String</td>
      <td>yes</td>
      <td>
        Street name of where the passenger would like to be collected.
      </td>
    </tr>
    <tr>
      <td><code>start_city</code></td>
      <td>String</td>
      <td>no</td>
      <td>
        City name of pick up location.
      </td>
    </tr>
    <tr>
      <td><code>vehicle_type_id</code></td>
      <td>String</td>
      <td>yes</td>
      <td>
        ID of the vehicle type that the journey should search for.
      </td>
    </tr>
    <tr>
      <td><code>end_loc</code></td>
      <td>[Float, Float]</td>
      <td>no</td>
      <td>
        Array containing latitude and longitude of the approximate destination.
      </td>
    </tr>
    <tr>
      <td><code>end_name</code></td>
      <td>String</td>
      <td>no</td>
      <td>
        Street name of where the passenger would like to be dropped off.
      </td>
    </tr>
    <tr>
      <td><code>end_city</code></td>
      <td>String</td>
      <td>no</td>
      <td>
        City name of destination.
      </td>
    </tr>
    <tr>
      <td><code>message</code></td>
      <td>String</td>
      <td>no</td>
      <td>
        Message to include in the request for the driver.
      </td>
    </tr>
    <tr>
      <td><code>charge_code</code></td>
      <td>String</td>
      <td>yes/no</td>
      <td>
        Only relevant for users who require charge codes to be associated with each journey. Some corporate accounts require this value to be provided with a specific format.
      </td>
    </tr>
  </tbody>
</table>



### Response